<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (c) 2014 IMOCOM. All Rights Reserved.

This software is the confidential and proprietary information of IMOCOM.
("Confidential Information").
It may not be copied or reproduced in any manner without the express
written permission of IMOCOM.
-->
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                template="/WEB-INF/facelets/templates/page-template_m.xhtml"
                xmlns:pm="http://primefaces.org/mobile">

    <ui:define name="content">
        <p><h1 align="center">Cargar Oportunidades Excel</h1></p>
        <p:separator style="width:90%" styleClass="separadores"/>
        <h:form id="crear-oportunidad-form" enctype="multipart/form-data">
            <h:panelGrid columns="3" id="grid_actcot"  styleClass="tablaDetalles" >           
                <p:outputLabel value="Archivo de Oportunidad :" styleClass="labelForm" rendered="true"/>
                <p:fileUpload value="#{oportunidadesCrearFacesBean.fileExcel}" allowTypes="/(\.|\/)(xls)$/" mode="simple" rendered="true" required="true"/>
                <p:commandButton id="btn_subir" value="Cargar Oportunidades"   ajax="false" actionListener="#{oportunidadesCrearFacesBean.cargarOportunidadesExcel}"  styleClass="backGIntelcom"/>            
            </h:panelGrid>
            <p:separator style="width:90%" />
            <p><h1>Oportunidades No Cargadas</h1></p> 
            <p:dataTable  id="tablaOportunidades" var="oportunidad" value="#{oportunidadesCrearFacesBean.listOporErrorExcel}" emptyMessage="Sin registros" styleClass="tablaresultados" tableStyleClass="detailTable">
                 <p:column id="col_nombre_as" headerText="Asesor">
                     <h:outputText id="ot_t_nombre_as" value="#{oportunidad.nombreUsuario}" styleClass="detailRows"/>
                 </p:column>   
                 <p:column id="col_nombre_cliente" headerText="Nit">
                     <h:outputText id="ot_t_nombre_cliente" value="#{oportunidad.idCliente}" styleClass="detailRows"/>
                 </p:column>  
                 <p:column id="col_nombre_observacion" headerText="Descripcion">
                     <h:outputText id="ot_t_nombre_observacion" value="#{oportunidad.observacion}" styleClass="detailRows"/>
                 </p:column>  
                 <p:column id="col_nombre_monto" headerText="Monto">
                      <h:outputText id="ot_t_monto" value="#{oportunidad.monto}" styleClass="detailRows"/>
                 </p:column>  
                <p:column id="col_nombre_canal" headerText="Canal">
                    <h:outputText id="ot_t_canal" value="#{oportunidad.idCanalEntrada}" styleClass="detailRows"/>
                </p:column> 
                 <p:column id="col_nombre_fcierre" headerText="Fecha Cierre">
                     <h:outputText id="ot_t_fcierre" value="#{oportunidad.fechaEstimadaCierre}" styleClass="detailRows"/>
                 </p:column>  
                 <p:column id="col_nombre_moneda" headerText="Moneda">
                     <h:outputText id="ot_t_moneda" value="#{oportunidad.idTipoMoneda}" styleClass="detailRows"/>
                 </p:column>
                <p:column id="col_nombre_pcliente" headerText="Probalidad Cliente">
                    <h:outputText id="ot_t_pcliente" value="#{oportunidad.probabilidadProyecto}" styleClass="detailRows"/>
                 </p:column>
                <p:column id="col_nombre_pimocom" headerText="Probalidad Imocom">
                    <h:outputText id="ot_t_pproyecto" value="#{oportunidad.probabilidadProyecto}" styleClass="detailRows"/>
                 </p:column>
                <p:column id="col_nombre_tipoOper" headerText="Tipo Oportunidad">
                    <h:outputText id="ot_t_tipoOper" value="#{oportunidad.idTipoOportunidad}" styleClass="detailRows"/>
                 </p:column>   
                  <p:column id="col_nombre_codprod" headerText="Codigo Producto">
                      <h:outputText id="ot_t_codprod" value="#{oportunidad.fisrtProducto.codigo}" styleClass="detailRows"/>
                 </p:column>   
                  <p:column id="col_nombre_unidad" headerText="Unidad">
                      <h:outputText id="ot_t_unidad" value="#{oportunidad.fisrtProducto.unidad}" styleClass="detailRows"/>
                 </p:column> 
                 <p:column id="col_nombre_cantidad" headerText="Cantidad">
                         <h:outputText id="ot_t_cantidad" value="#{oportunidad.fisrtProducto.cantidad}" styleClass="detailRows"/>
                 </p:column> 
                  <p:column id="col_nombre_mensaje" headerText="Mensaje">
                      <h:outputText id="ot_t_mensaje" value="#{oportunidad.respuestaCreacion}" styleClass="detailRows"/>
                 </p:column> 
            </p:dataTable>
        </h:form>
    </ui:define>    
</ui:composition> 
