SELECT DISTINCT hp.party_id, hp.PARTY_NUMBER , hp.party_name                        AS NOMBRE, hp.creation_date                     AS fecha_creacion, hp.jgzz_fiscal_code                  AS NIT , hp.address1                          AS DIRECCION , hp.city                              AS CIUDAD , hp.state                             AS DEPARTAMENTO, hp.url                               AS URL , hp.email_address                     AS CORREO , hp.PRIMARY_PHONE_NUMBER              AS TELEFONO, cod.CLASS_CODE                       AS TIPO_CLIENTE, DECODE(JTF_RS_RESOURCE_EXTNS.USER_NAME, rs.USER_NAME, decode(JTF_RS_RESOURCE_EXTNS.USER_NAME, fnd_user.USER_NAME, IMCM_DIAS_SIN_VISITA.DIAS_SIN_VISITA, null), -1) as diasSinVisiat FROM ar.hz_parties hp INNER JOIN hz_code_assignments cod ON (cod.owner_table_id = hp.party_id) LEFT OUTER JOIN IMCM_DIAS_SIN_VISITA ON (hp.PARTY_ID = IMCM_DIAS_SIN_VISITA.PARTY_ID) LEFT OUTER JOIN fnd_user ON (fnd_user.user_id = IMCM_DIAS_SIN_VISITA.user_id ) LEFT OUTER JOIN AS_ACCESSES_ALL acc ON (acc.CUSTOMER_ID      = hp.PARTY_ID ), JTF_RS_RESOURCE_EXTNS, JTF_RS_RESOURCE_EXTNS rs WHERE party_type         = 'ORGANIZATION' AND hp.ATTRIBUTE16       = 'C' AND cod.owner_table_name = 'HZ_PARTIES' AND cod.class_category   = 'Estado del Cliente' AND rs.SOURCE_ID         = acc.PERSON_ID AND acc.SALES_LEAD_ID   IS NULL AND acc.LEAD_ID         IS NULL AND UPPER(party_name) LIKE #v_nombreEmpresa AND jgzz_fiscal_code LIKE #v_nit AND rs.USER_NAME LIKE #v_asesor AND UPPER(cod.CLASS_CODE) LIKE #v_tipo_cliente AND DECODE(IMCM_DIAS_SIN_VISITA.SEMAFORO, NULL, ' ',UPPER(IMCM_DIAS_SIN_VISITA.SEMAFORO)) LIKE #v_semaforo AND JTF_RS_RESOURCE_EXTNS.USER_NAME LIKE #v_asesor1 ORDER BY hp.party_name ASC