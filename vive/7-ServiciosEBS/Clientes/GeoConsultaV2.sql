SELECT DISTINCT hp.party_id, hp.party_number , hp.party_name                                                         AS NOMBRE, hp.creation_date                                                      AS fecha_creacion, DECODE(hp.jgzz_fiscal_code, NULL, hp.ATTRIBUTE1, hp.jgzz_fiscal_code) AS NIT , hp.address1                                                           AS DIRECCION , hp.city                                                               AS CIUDAD , hp.state                                                              AS DEPARTAMENTO, hp.url                                                                AS URL , hp.email_address                                                      AS CORREO , hp.PRIMARY_PHONE_NUMBER                                               AS TELEFONO, hp.attribute17                                                        AS LONGITUD, DECODE(RS.USER_NAME, FND_USER.USER_NAME, DSV.DIAS_SIN_VISITA, -0) AS diasSinVisita FROM ar.hz_parties hp LEFT OUTER JOIN IMCM_DIAS_SIN_VISITA DSV ON (DSV.PARTY_ID = hp.PARTY_ID) LEFT OUTER JOIN FND_USER ON (DSV.USER_ID = FND_USER.USER_ID) LEFT OUTER JOIN AS_ACCESSES_ALL ACC ON (ACC.CUSTOMER_ID = hp.PARTY_ID), JTF_RS_RESOURCE_EXTNS RS, hz_code_assignments cod WHERE party_type         = 'ORGANIZATION' AND cod.owner_table_name = 'HZ_PARTIES' AND cod.class_category   = 'Estado del Cliente' AND hp.ATTRIBUTE16  = 'C' AND (cod.CLASS_CODE LIKE 'Activo' OR cod.CLASS_CODE LIKE 'Prospecto') AND cod.owner_table_id = hp.party_id AND hp.attribute17    IS NOT NULL AND ACC.PERSON_ID = RS.SOURCE_ID AND RS.USER_NAME LIKE #v_asesor